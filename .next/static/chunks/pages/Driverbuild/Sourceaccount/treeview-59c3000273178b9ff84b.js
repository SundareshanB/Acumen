(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9054],{75177:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(85893),i=n(87329),c=n(96156),o=n(2949),a=n(67294),l=n(41120),u=n(95425),d=n(80131),s=n(22318),f=n(89039),h=n(52504),p=n(90064),v=n(97305),m=n(13258),w=n(96908),b=n(49226),x=n(64436),g=n(43700),k=n(26209),j=n(9669),V=n.n(j),N=n(282);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){var t=(0,p.AC)(),n=e.labelText,i=(e.labelIcon,e.labelInfo,e.color),a=e.bgColor,l=(0,o.Z)(e,["labelText","labelIcon","labelInfo","color","bgColor"]);return(0,r.jsx)(d.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({label:(0,r.jsx)("div",{className:t.labelRoot,children:(0,r.jsx)(s.Z,{variant:"body2",className:t.labelText,children:n})}),style:{"--tree-view-color":i,"--tree-view-bg-color":a,"--tree-view-height":38},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},l))}var y=(0,l.Z)({root:{height:157,flexGrow:1,overflow:"auto",border:"1px solid",margin:10,borderRadius:6},formControl:{marginRight:5,minWidth:120},labelname:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"75%",transform:"translate(14px,3px) scale(1)","&.MuiInputLabel-outlined.MuiInputLabel-shrink":{display:"none"}},treeviewtop:{display:"flex",justifyContent:"space-between",alignItems:"center"},checkbox:{"&.MuiCheckbox-colorSecondary.Mui-checked":{color:"#810000"}}});function E(e){var t=e.setData,n=y(),o=(0,a.useState)([]),l=o[0],d=o[1],s=(0,a.useState)((0,i.Z)(v)),j=s[0],Z=s[1],E=[],_=(0,a.useState)([]),C=_[0],I=_[1],D=(0,a.useState)(0),P=D[0],R=D[1],S=(0,b.I0)(),T=(0,b.v9)((function(e){return e.header.stage})),B=(0,b.v9)((function(e){return e.header.period})),M=(0,b.v9)((function(e){return e.account.accountdetails}));(0,a.useEffect)((function(){fetch("http://[::1]:3000/center-hierarchies/treeview").then((function(e){return e.json()})).then((function(e){return Z(e)})),t("")}),[]),(0,a.useEffect)((function(){j.map((function(e){e.stage===T&&E.push(e)})),E.map((function(e){P<e.Node&&(P=e.Node)})),R(P);for(var e=function(e){E.map((function(t,n){t.Node===e&&(Object.assign(t,(0,c.Z)({},"checked",!1)),0!==t.treeView.length&&t.treeView.map((function(e){Object.assign(e,(0,c.Z)({},"checked",!1))})))}))},t=P;t>0;t--)e(t);for(var n=[],r=function(e){E.map((function(t,r){t.Node===e&&E.map((function(e){if(e.refNum===t.parentRefNum){var c=e.treeView.some((function(e){return e._id===t._id}));e.treeView=c?(0,i.Z)(e.treeView):[].concat((0,i.Z)(e.treeView),[t]),n.push(r)}}))}))},o=P;o>0;o--)r(o);for(var a=[],l=0;l<E.length;l++)n.includes(l)||a.push(E[l]);d([].concat(a))}),[v,j]);var A=function e(t){var i=t.parent;return t.data.map((function(c){return void 0!==c.treeView&&0!==c.treeView.length?(0,r.jsx)(O,{nodeId:c._id,labelText:(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:n.checkbox,checked:c.checked,onClick:function(e){return X(e,c)}})," ",c.name]}),color:"#810000",bgColor:"#EEEBDD",children:(0,r.jsx)(e,{data:c.treeView,parent:i})}):(0,r.jsx)(O,{nodeId:c._id.$oid,labelText:(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:n.checkbox,checked:c.checked,onClick:function(e){return z(t.data,c,i)}})," ",c.name]}),color:"#810000",bgColor:"#EEEBDD"})}))},L=function e(t){t.checked=!0,void 0===t.treeView&&C.push(t),I((0,i.Z)(C));var n=t;if(n.treeView&&0!==n.treeView.length||void 0!==n.treeView)for(var r=0;r<n.treeView.length;r++)n.treeView[r].checked=!0,e(n.treeView[r])},q=function e(t){if(t.checked=!1,void 0===t.treeView){var n=C.findIndex((function(e){return e.name===t.name}));C.splice(n,1)}I((0,i.Z)(C));var r=t;if(r.treeView&&0!==r.treeView.length||void 0!==r.treeView)for(var c=0;c<r.treeView.length;c++)r.treeView[c].checked=!1,e(r.treeView[c])},K=function(e,t){for(var n=e,r=t,i=P;i>0;i--)j.map((function(e){n===e.refNum&&(void 0!==e.treeView&&0!==e.treeView.length?e.treeView.every((function(e){return!0===e.checked}))?(e.checked=!0,n=e.parentRefNum):(e.checked=!1,n=e.parentRefNum):(e.checked=r,n=e.parentRefNum))}))},X=function(e,t){if(!1===t.checked){if(t.checked=!0,0!==t.treeView.length)for(var n=0;n<t.treeView.length;n++)L(t.treeView[n]);K(t.parentRefNum,!0)}else if(!0===t.checked){if(t.checked=!1,0!==t.treeView.length)for(var r=0;r<t.treeView.length;r++)q(t.treeView[r]);K(t.parentRefNum,!1)}d((0,i.Z)(l))},z=function(e,t,n){var r=0;if(!1===t.checked)C.push(t),I((0,i.Z)(C)),t.checked=!0;else{t.checked=!1;var c=C.findIndex((function(e){return e.name===t.name}));C.splice(c,1),I((0,i.Z)(C))}if(0!==e.length&&e.map((function(e){!0===e.checked&&(r+=1)})),r===e.length&&void 0!==n){var o=t.parentRefNum;K(o,!0)}else if(void 0!==n){var a=t.parentRefNum;K(a,!1)}d((0,i.Z)(l))},F=function e(t){t.map((function(t){t.checked=!1,void 0!==t.treeView&&(t.checked=!1,e(t.treeView))}))};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:n.treeviewtop,children:[(0,r.jsxs)(x.Z,{variant:"outlined",disabled:!0,className:n.formControl,children:[(0,r.jsx)(g.Z,{className:n.labelname,id:"demo-simple-select-outlined-label",children:"Financial"}),(0,r.jsx)(k.Z,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",label:"Age",input:(0,r.jsx)(p.xi,{})})]}),(0,r.jsx)(N.Z,{variant:"contained",color:"primary",onClick:function(){C.map((function(e){V().get("http://[::1]:3000/account-drivers/accountDetails",{params:{period:B,refNum:e.refNum}}).then((function(n){console.log(n.data);var r={refNum:e.refNum,period:B,driver:M[0].driverLink[0].driverName,profile:M[0].profile};V()({method:"patch",url:"http://[::1]:3000/account-drivers/assignDriverProfile",params:r}).then((function(e){"OK"===e.statusText&&t("OK")}))})).catch((function(e){return console.log(e)})),l.map((function(e){e.checked=!1,void 0!==e.treeView&&F(e.treeView)})),d((0,i.Z)(l)),S((0,w.q)(C))}))},size:"small",children:"Assign Selected"})]}),(0,r.jsx)(u.Z,{className:n.root,defaultExpanded:["3"],defaultCollapseIcon:(0,r.jsx)(f.Z,{}),defaultExpandIcon:(0,r.jsx)(h.Z,{}),defaultEndIcon:(0,r.jsx)("div",{style:{width:24}}),children:l.map((function(e){return(0,r.jsx)(O,{nodeId:e._id,labelText:(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:n.checkbox,checked:e.checked,onClick:function(t){return 0!==e.treeView.length?X(t,e):z([],e)}})," ",e.name]}),color:"#810000",bgColor:"#EEEBDD",children:0!==e.treeView.length&&(0,r.jsx)(A,{data:e.treeView,parent:e})})}))})]})}},96908:function(e,t,n){"use strict";n.d(t,{_:function(){return i},q:function(){return c}});var r=n(17695),i=function(e){return{type:r.B,payload:e}},c=function(e){return{type:r.O,payload:e}}},87860:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Driverbuild/Sourceaccount/treeview",function(){return n(75177)}])}},function(e){e.O(0,[7853,2342,4593,4422,4720,4203,3121,3258,6371,6144,9774,2888,179],(function(){return t=87860,e(e.s=t);var t}));var t=e.O();_N_E=t}]);